<HTML>

<!-- Generated by c2html-1.0, Copyright 1998 by Dave Whittington -->
<HEAD>
<TITLE>lmgr.c</TITLE>
<!--#include virtual="/ssi/js.shtml" -->
<!--#include virtual="/ssi/buttondefs.shtml" -->
</HEAD>
<BODY BGCOLOR="#FFFFFF">
<TABLE WIDTH="100%">
<TR>
<TD ALIGN=LEFT WIDTH="90"><!--#include virtual="/ssi/b_home.shtml" --></TD>
<TD ALIGN=RIGHT WIDTH="90"><!--#include virtual="/ssi/b_index.shtml" --></TD>
</TR>
</TABLE>
<CENTER><H1>lmgr.c</H1></CENTER>

<HR>
<PRE>
<FONT COLOR=#0000FF>/* $Id$

 * Author       Karsten Keil (keil@temic-ech.spacenet.de)
 *
 *
 *  Layermanagement module
 *
 * $Log$
 * Revision 1.4  1998/05/25 12:58:19  keil
 * HiSax golden code from certification, Don't use !!!
 * No leased lines, no X75, but many changes.
 *
 * Revision 1.3  1998/03/07 22:57:06  tsbogend
 * made HiSax working on Linux/Alpha
 *
 * Revision 1.2  1997/10/29 19:09:34  keil
 * new L1
 *
 * Revision 1.1  1997/06/26 11:17:25  keil
 * first version
 *
 *
 */</FONT>

<FONT COLOR=#A521F7>#define</FONT> <A HREF="asuscom.c.shtml#__NO_VERSION__">__NO_VERSION__</A>
<FONT COLOR=#A521F7>#include</FONT> <FONT COLOR="#FF0000">"hisax.h"</FONT>

<FONT COLOR="#298C52">static</FONT> <FONT COLOR="#298C52">void</FONT>
<A HREF="#error_handling_dchan">error_handling_dchan</A>(<FONT COLOR="#298C52">struct</FONT> PStack *st, <FONT COLOR="#298C52">int</FONT> Error)
{
	<FONT COLOR="#298C52">switch</FONT> (Error) {
		<FONT COLOR="#298C52">case</FONT> <FONT COLOR="#FF0000">'C'</FONT>:
		<FONT COLOR="#298C52">case</FONT> <FONT COLOR="#FF0000">'D'</FONT>:
		<FONT COLOR="#298C52">case</FONT> <FONT COLOR="#FF0000">'G'</FONT>:
		<FONT COLOR="#298C52">case</FONT> <FONT COLOR="#FF0000">'H'</FONT>:
			st-&gt;l2.l2tei(st, <A HREF="hisax.h.shtml#MDL_ERROR">MDL_ERROR</A> | <A HREF="hisax.h.shtml#REQUEST">REQUEST</A>, NULL);
			<FONT COLOR="#298C52">break</FONT>;
	}
}

<FONT COLOR="#298C52">static</FONT> <FONT COLOR="#298C52">void</FONT>
<A HREF="#hisax_manager">hisax_manager</A>(<FONT COLOR="#298C52">struct</FONT> PStack *st, <FONT COLOR="#298C52">int</FONT> pr, <FONT COLOR="#298C52">void</FONT> *arg)
{
	<FONT COLOR="#298C52">char</FONT> tm[32], str[256];
	<FONT COLOR="#298C52">long</FONT> Code;

	<FONT COLOR="#298C52">switch</FONT> (pr) {
		<FONT COLOR="#298C52">case</FONT> (<A HREF="hisax.h.shtml#MDL_ERROR">MDL_ERROR</A> | <A HREF="hisax.h.shtml#INDICATION">INDICATION</A>):
			Code = (<FONT COLOR="#298C52">long</FONT>) arg;
			<A HREF="fsm.c.shtml#jiftime">jiftime</A>(tm, jiffies);
			sprintf(str, <FONT COLOR="#FF0000">"%s manager: MDL_ERROR %c %s\n"</FONT>, tm,
				(<FONT COLOR="#298C52">char</FONT>)Code, test_bit(<A HREF="hisax.h.shtml#FLG_LAPD">FLG_LAPD</A>, &amp;st-&gt;l2.flag) ?
				<FONT COLOR="#FF0000">"D-channel"</FONT> : <FONT COLOR="#FF0000">"B-channel"</FONT>);
			<A HREF="isdnl1.c.shtml#HiSax_putstatus">HiSax_putstatus</A>(st-&gt;l1.hardware, str);
			<FONT COLOR="#298C52">if</FONT> (test_bit(<A HREF="hisax.h.shtml#FLG_LAPD">FLG_LAPD</A>, &amp;st-&gt;l2.flag))
				<A HREF="#error_handling_dchan">error_handling_dchan</A>(st, Code);
			<FONT COLOR="#298C52">break</FONT>;
	}
}

<FONT COLOR="#298C52">void</FONT>
<A NAME="setstack_manager">setstack_manager</A>(<FONT COLOR="#298C52">struct</FONT> PStack *st)
{
	st-&gt;ma.layer = <A HREF="#hisax_manager">hisax_manager</A>;
}
</BODY>

</HTML>
